{"version":3,"file":"vue.js","sources":["../src/util.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\n    return typeof val === 'function'\n}\nexport function isObject(val) {\n    return typeof val === 'object' && val !== null\n}\n","import { isObject } from '../util'\n\n//检测数据变化，类有类型，对象无类型\nclass Observer {\n    constructor(data) { //对对象中的所有属性进行劫持\n        //用户很少通过索引数组 arr[98]=100,所以内部想到不对索引进行拦截，因为消耗严重\n        //经常使用 push shift pop unshift reverse sort splice 7个变异方法，可能会更改原数组\n        if (Array.isArray(data)) { //数组劫持的拦截\n            //对数组原来的方法进行改写,切片编程 高阶函数（包装一层）\n\n        } else {\n            this.walk(data) //对象劫持的拦截\n        }\n    }\n    walk(data) { //对象\n        Object.keys(data).forEach(key => {\n            defineReactive(data, key, data[key])\n        })\n    }\n}\n//vue2会对对象进行递归遍历，将每个属性用 defineProperty 重新定义 性能差\nfunction defineReactive(data, key, value) {\n    observer(value) //对象尽可能扁平化，不要多层递归\n    Object.defineProperty(data, key, {\n        get() {\n            return value;\n        },\n        set(newV) { //如果用户赋值一个新对象，需要将这个对象进行劫持\n            observer(newV)\n            value = newV\n        }\n    })\n}\nexport function observer(data) {\n    console.log(data)\n    //如果是对象才观测\n    if (!isObject(data)) {\n        return;\n    }\n    return new Observer(data)\n}","import { isFunction } from './util'\nimport { observer } from './observer/index'\nexport function initState(vm) { //表示在vue的基础上做一次混合操作\n    const opts = vm.$options\n    if (opts.data) {\n        initData(vm)\n    }\n    // if (opts.computed) {\n    //     initComputed()\n    // }\n    // if (opts.watch) {\n    //     initWatch()\n    // }\n}\nfunction proxy(vm, source, key) {\n    Object.defineProperty(vm, key, {\n        get() {\n            return vm[source][key]\n        },\n        set(newVal) {\n            vm[source][key] = newVal\n        }\n    })\n}\nfunction initData(vm) { //vue的内部变量以$开头，不会进行代理\n    let data = vm.$options.data\n    //vue2 会将data中对所有数据，进行数据劫持 Object.defineProperty\n    //这个时候vm和data没有关系，通过_data进行关联\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\n    for (let key in data) { //vm.name =>am._data.name 代理\n        proxy(vm, '_data', key)\n    }\n    observer(data)\n}","import { initState } from './state'\nexport function initMixin(Vue) { //表示在vue的基础上做一次混合操作\n    Vue.prototype._init = function (options) {\n        const vm = this;\n        vm.$options = options;\n        //对数据进行初始化\n        initState(vm) //vm.$options.data...\n    }\n}","import { initMixin } from './init'\nfunction Vue(options) {\n    //options 为用户传入的选项\n    this._init(options) //初始化操作，组件\n}\ninitMixin(Vue)\nexport default Vue"],"names":["isFunction","val","isObject","Observer","data","Array","isArray","walk","Object","keys","forEach","key","defineReactive","value","observer","defineProperty","get","set","newV","console","log","initState","vm","opts","$options","initData","proxy","source","newVal","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":"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"}